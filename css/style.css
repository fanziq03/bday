/* =================================
   Reset, Base & Page System
   ================================= */
* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body { font-family: 'Poppins', sans-serif; background: #111; overflow: hidden; -webkit-tap-highlight-color: transparent; }
.page { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100vh; overflow: hidden;
    opacity: 0; transform: scale(1.05); pointer-events: none;
    transition: opacity 0.6s ease-in-out, transform 0.6s ease-in-out; 
}
.page.active { 
    opacity: 1; transform: scale(1); pointer-events: auto;
}
.page-content { display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; height: 100%; text-align: center; padding: 20px; position: relative; z-index: 10; }

/* =================================
   PAGE 1: Gift Box Only
   ================================= */
#page1 { background: #f8f9ff; }
.gift-box-wrapper { position: relative; transform: scale(0.9); }
.gift-box { cursor: pointer; transition: transform 0.3s ease; }
.gift-box.shake { animation: shake 0.5s ease; } @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
.gift-base { width: 250px; height: 200px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); border-radius: 10px; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
.gift-base::before, .gift-base::after { content: ''; position: absolute; background: #ffd700; top: 50%; left: 50%; transform: translate(-50%, -50%); }
.gift-base::before { width: 30px; height: 100%; } .gift-base::after { width: 100%; height: 30px; }
.gift-lid { width: 270px; height: 80px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%); border-radius: 10px 10px 0 0; position: absolute; top: -60px; left: 50%; transform: translateX(-50%); box-shadow: 0 5px 20px rgba(0,0,0,0.2); transition: all 0.5s ease; }
.gift-box.opened .gift-lid { transform: translateX(-50%) translateY(-100px) rotateZ(-20deg); opacity: 0; }
.gift-bow { width: 80px; height: 80px; background: #ffd700; border-radius: 50%; position: absolute; top: -40px; left: 50%; transform: translateX(-50%); }
.gift-bow::before, .gift-bow::after { content: ''; position: absolute; width: 60px; height: 40px; background: #ffd700; border-radius: 50%; top: 20px; }
.gift-bow::before { left: -50px; } .gift-bow::after { right: -50px; }
.click-counter { position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%); background: rgba(255,255,255,0.9); padding: 10px 25px; border-radius: 50px; font-size: 1.5rem; font-weight: 700; color: #667eea; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
#clickCount { color: #ff6b6b; font-size: 2rem; }

/* =================================
   PAGE 2: Birthday Reveal (FINAL DESIGN)
   ================================= */
#page2 { 
    background: linear-gradient(to bottom, #020111 0%, #20202c 100%);
    perspective: 1500px; 
}
#fireworksCanvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; }
.landscape-silhouette {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 25%;
    background-image: url("data:image/svg+xml,%3Csvg width='1920' height='480' viewBox='0 0 1920 480' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 480V350 C50 345, 100 355, 150 360 L150 320 L170 320 L170 360 C200 365, 250 350, 300 340 L300 300 L320 300 L320 340 L340 340 L340 280 L350 280 L350 340 C400 330, 450 350, 500 360 L500 250 L520 250 L520 360 C600 380, 650 370, 700 350 L750 200 C800 150, 900 150, 950 200 L1000 250 C1100 200, 1200 250, 1300 300 C1400 350, 1500 340, 1600 360 L1600 330 L1620 330 L1620 360 C1700 370, 1800 360, 1920 350V480H0Z' fill='%23101018'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center bottom;
    background-size: cover;
    z-index: 2;
}
.birthday-card { 
    width: clamp(340px, 90vw, 480px); /* WIDENED CARD */
    height: clamp(420px, 70vh, 500px); 
    position: relative; 
    transform-style: preserve-3d; 
    transition: transform 1s cubic-bezier(0.25, 1, 0.5, 1); 
    cursor: pointer; 
}
.birthday-card.is-flipped { transform: rotateY(180deg); cursor: default; }
.birthday-card.pop-out { animation: popOut 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
@keyframes popOut { 0% { transform: scale(1); } 30% { transform: scale(1.1); } 100% { transform: rotateY(180deg) scale(1); } }
.birthday-card-front, .birthday-card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25); display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; }
.birthday-card-front { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
.card-penguin { width: 60%; max-width: 180px; margin-bottom: 20px; animation: bounce 2s infinite ease-in-out; }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
.card-title { font-family: 'Pacifico', cursive; font-size: clamp(1.6rem, 5vw, 2.2rem); color: #ff6f69; }
.birthday-card-back { background: rgba(255, 245, 231, 0.85); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3); transform: rotateY(180deg); }
.birthday-greeting { 
    font-family: 'Fredoka One', cursive; 
    font-size: clamp(1.8rem, 6vw, 2.6rem); /* ADJUSTED FONT SIZE */
    color: #ff6f69; 
    margin-bottom: 20px; 
    white-space: nowrap; /* PREVENTS WRAPPING */
}
.birthday-greeting .char { display: inline-block; opacity: 0; transform: translateY(20px) scale(0.5) rotate(20deg); animation: burstIn 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
@keyframes burstIn { to { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); } }
.balloons-static { display: flex; justify-content: center; margin-bottom: 20px; }
.balloon-static { width: 35px; height: 45px; background: #ffb3ba; border-radius: 50%; margin: 0 8px; position: relative; animation: floatUp 3s ease-in-out infinite; }
.balloon-static:nth-child(2) { background: #ffdfba; animation-delay: 1s; }
.balloon-static:nth-child(3) { background: #baffc9; animation-delay: 2s; }
.balloon-static::after { content: ''; position: absolute; bottom: -16px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 4px solid transparent; border-right: 4px solid transparent; border-bottom: 16px solid #a8a8a8; }
@keyframes floatUp { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
.birthday-message { font-size: clamp(0.9rem, 3vw, 1.1rem); color: #575757; margin-bottom: 30px; }
.next-page-btn { padding: 12px 28px; font-size: 1rem; font-weight: 600; color: #fff; background-color: #ff6f69; border: none; border-radius: 50px; cursor: pointer; transition: all 0.3s ease; transform: scale(0); opacity: 0; }
.birthday-card.is-flipped .next-page-btn { animation: popInButton 0.5s ease-out 1.5s forwards; }
@keyframes popInButton { to { transform: scale(1); opacity: 1; } }
.next-page-btn:hover { background-color: #ff8a85; transform: translateY(-3px); }
.tap-indicator { position: absolute; bottom: 8vh; left: 50%; transform: translateX(-50%); color: white; font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 1.2rem; padding: 10px 20px; background: rgba(0,0,0,0.3); border-radius: 20px; animation: pulse 2s infinite; transition: opacity 0.5s ease; z-index: 11; }
.tap-indicator.hidden { opacity: 0; pointer-events: none; }
@keyframes pulse { 0%, 100% { transform: translateX(-50%) scale(1); } 50% { transform: translateX(-50%) scale(1.05); } }
/* Starry Background */
.star-field { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
@keyframes animStar { from { transform: translateY(0px); } to { transform: translateY(-2000px); } }
@keyframes twinkle { 0% { opacity: 0.1; } 50% { opacity: 1; } 100% { opacity: 0.1; } }
#stars, #stars2, #stars3 { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 1px; height: 1px; background: transparent; }
#stars { animation: animStar 150s linear infinite, twinkle 3s infinite; }
#stars2 { animation: animStar 100s linear infinite, twinkle 5s infinite; }
#stars3 { animation: animStar 50s linear infinite, twinkle 7s infinite; }

/* =================================
   PAGE 3: Message Section
   ================================= */
#page3 { height: auto; min-height: 100vh; display: flex; justify-content: center; align-items: center; }
.page3-background { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; background: linear-gradient(to top, #fff1eb 0%, #ace0f9 100%); }
.page3-decorations { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; overflow: hidden; }
.balloon-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.balloon { position: absolute; bottom: -200px; width: 100px; height: 120px; cursor: pointer; transition: transform 0.3s ease; animation: rise 20s linear infinite; }
.balloon:hover { transform: scale(1.1); }
.balloon-body { width: 100%; height: 100%; background: rgba(149, 153, 226, 0.8); border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; transition: transform 0.3s ease, opacity 0.3s ease; }
.balloon-tail { position: absolute; left: 50%; bottom: -60px; width: 2px; height: 60px; background: rgba(0,0,0,0.2); transform-origin: top center; transition: opacity 0.3s ease; animation: wave 3s ease-in-out infinite; }
@keyframes rise { 0% { transform: translateY(0) rotate(0deg); } 100% { transform: translateY(-120vh) translateX(10vw) rotate(10deg); } }
@keyframes wave { 0%, 100% { transform: rotate(5deg); } 50% { transform: rotate(-5deg); } }
.pop-text { font-family: 'Bangers', cursive; font-size: 5rem; text-shadow: 2px 2px 0 rgba(255,255,255,0.7); position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); opacity: 0; pointer-events: none; }
.balloon.popped .balloon-body, .balloon.popped .balloon-tail { transform: scale(0); opacity: 0; }
.balloon.popped .pop-text { animation: popEffect 2s ease-out forwards; }
@keyframes popEffect { 0% { transform: translate(-50%,-50%) scale(0); opacity:1; } 20% { transform: translate(-50%,-50%) scale(1.2); } 40% { transform: translate(-50%,-50%) scale(0.9); } 100% { transform: translate(-50%,-50%) scale(1); opacity:0; } }
.message-wrapper { max-width: 900px; width: 100%; z-index: 10; padding: 40px 20px; position: relative;}
.back-btn { position: absolute; top: 0; left: 20px; background: rgba(255,255,255,0.4); border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; color: #555; cursor: pointer; transition: all 0.3s ease; }
.back-btn:hover { background: rgba(255,255,255,0.7); transform: scale(1.05); }
.message-container { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: 30px; padding: clamp(30px, 5vw, 60px); box-shadow: 0 20px 60px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); color: #333; }
.message-header { text-align: center; margin-bottom: 30px; }
.message-title { font-family: 'Pacifico', cursive; font-size: clamp(1.8rem, 4vw, 3rem); color: #C850C0; text-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.audio-controls { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-bottom: 30px; }
.btn { padding: 15px 30px; border: none; border-radius: 50px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
.btn:hover { transform: translateY(-3px); }
.btn-voice { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
.btn-music { background: rgba(255,255,255,0.3); color: #333; }
.message-content { color: #333; }
.message-text { font-size: clamp(1rem, 2vw, 1.1rem); line-height: 1.8; margin-bottom: 25px; }
.message-signature { margin-top: 40px; text-align: right; }
.signature-name { font-family: 'Pacifico', cursive; font-size: 1.5rem; color: #C850C0; }
.signature-penguin img { width: 80px; height: auto; }

/* Responsive Adjustments */
@media (max-width: 768px) {
    .gift-base { width: 200px; height: 160px; }
    .gift-lid { width: 220px; height: 60px; }
    .audio-controls { flex-direction: column; }
    .btn { width: 100%; }
    .back-btn { top: -10px; }
}